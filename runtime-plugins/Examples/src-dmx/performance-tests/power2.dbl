#import "../dbl"

module powerExtensionDef {

	extension PowerExpr extends dbl L1Expr {
		start PowerExpr;
		PowerExpr -> factor:L1Expr "^" power:L1Expr;
	}
	semantics {
		expand "r";
		
		Statement s = null;
		EObject c = factor.eContainer();
		while (s == null) {
			if (c instanceof Statement) {
				s = c as Statement;
			}
			else {
				c = c.eContainer();
			}
		}
		print s;
	
		setExpansionContext before s;
		expand "int p=" power ";";
		expand "int r=" factor ";";
		expand "while (p > 1) { r=r*" factor "; p=p-1; }";
	}

}